<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TravelCompare | Indian Travel Booking - Price Transparency</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
  <style>
    :root {
      --white: #FFFFFF;
      --soft-blue-50: #F0F7FF;
      --soft-blue-100: #E3EFFD;
      --soft-blue-200: #C7DFFA;
      --soft-blue-300: #9CC5F7;
      --soft-blue-500: #3B82F6;
      --soft-blue-600: #2563EB;
      --green-50: #ECFDF5;
      --green-200: #A7F3D0;
      --green-400: #34D399;
      --green-500: #10B981;
      --green-600: #059669;
      --gray-50: #F8FAFC;
      --gray-100: #F1F5F9;
      --gray-200: #E2E8F0;
      --gray-400: #94A3B8;
      --gray-600: #64748B;
      --gray-800: #1E293B;
      --gray-900: #0F172A;
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.04);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.06), 0 2px 4px -2px rgba(0, 0, 0, 0.04);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.06), 0 4px 6px -4px rgba(0, 0, 0, 0.04);
      --shadow-glow: 0 0 0 1px rgba(16, 185, 129, 0.2), 0 0 24px rgba(16, 185, 129, 0.15);
      --radius: 16px;
      --radius-sm: 12px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, var(--soft-blue-50) 0%, var(--white) 50%, var(--gray-50) 100%);
      color: var(--gray-900);
      min-height: 100vh;
      line-height: 1.5;
    }

    .comparison-section {
      max-width: 1400px;
      margin: 0 auto;
      padding: 32px 24px 64px;
    }

    .section-header {
      margin-bottom: 32px;
    }

    .section-header h1 {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--gray-900);
      letter-spacing: -0.02em;
    }

    .section-header p {
      color: var(--gray-600);
      margin-top: 6px;
      font-size: 0.9375rem;
    }

    /* Filters */
    .filters-bar {
      background: var(--white);
      border-radius: var(--radius);
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: var(--shadow-md);
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: center;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .filter-group label {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--gray-600);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .filter-group select,
    .filter-group input[type="range"] {
      font-family: inherit;
      padding: 10px 14px;
      border: 1px solid var(--gray-200);
      border-radius: var(--radius-sm);
      background: var(--white);
      font-size: 0.875rem;
      min-width: 140px;
    }

    .budget-slider {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .budget-slider input[type="range"] {
      width: 120px;
      padding: 0;
    }

    .budget-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--gray-800);
      min-width: 60px;
    }

    .toggle-group {
      display: flex;
      background: var(--gray-100);
      border-radius: var(--radius-sm);
      padding: 4px;
      gap: 2px;
    }

    .toggle-btn {
      padding: 8px 16px;
      border: none;
      background: transparent;
      border-radius: 10px;
      font-size: 0.8125rem;
      font-weight: 500;
      color: var(--gray-600);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .toggle-btn:hover {
      color: var(--gray-800);
    }

    .toggle-btn.active {
      background: var(--white);
      color: var(--soft-blue-600);
      box-shadow: var(--shadow-sm);
    }

    .ai-toggle {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      background: linear-gradient(135deg, var(--soft-blue-50), var(--white));
      border: 1px solid var(--soft-blue-200);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .ai-toggle:hover {
      border-color: var(--soft-blue-300);
    }

    .ai-toggle input {
      width: 18px;
      height: 18px;
      accent-color: var(--green-500);
    }

    .ai-toggle span {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--gray-800);
    }

    /* Comparison Toggle */
    .comparison-mode {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 24px;
      padding: 16px 20px;
      background: var(--white);
      border-radius: var(--radius);
      box-shadow: var(--shadow-md);
    }

    .comparison-mode span {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--gray-600);
    }

    .comparison-slots {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .comparison-slot {
      padding: 8px 16px;
      border: 2px dashed var(--gray-200);
      border-radius: var(--radius-sm);
      font-size: 0.8125rem;
      color: var(--gray-400);
      min-width: 120px;
      text-align: center;
    }

    .comparison-slot.filled {
      border-style: solid;
      border-color: var(--soft-blue-300);
      background: var(--soft-blue-50);
      color: var(--gray-800);
    }

    /* AI Insight Panel */
    .ai-insight-panel {
      background: linear-gradient(135deg, var(--soft-blue-50) 0%, rgba(16, 185, 129, 0.08) 100%);
      border: 1px solid var(--soft-blue-200);
      border-radius: var(--radius);
      padding: 20px 24px;
      margin-bottom: 24px;
      display: flex;
      align-items: flex-start;
      gap: 16px;
    }

    .ai-insight-icon {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, var(--green-500), var(--green-600));
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .ai-insight-icon svg {
      width: 24px;
      height: 24px;
      color: white;
    }

    .ai-insight-content h3 {
      font-size: 0.9375rem;
      font-weight: 700;
      color: var(--gray-900);
      margin-bottom: 4px;
    }

    .ai-insight-content p {
      font-size: 0.875rem;
      color: var(--gray-600);
    }

    /* Travel Cards Grid */
    .travel-cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
      gap: 24px;
    }

    .travel-card {
      background: var(--white);
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: var(--shadow-md);
      border: 1px solid transparent;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .travel-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
      border-color: var(--soft-blue-200);
    }

    .travel-card.best-value {
      border-color: var(--green-400);
      box-shadow: var(--shadow-glow);
    }

    .travel-card.best-value .badge-best-value {
      animation: subtle-pulse 2s ease-in-out infinite;
    }

    @keyframes subtle-pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.9; }
    }

    .travel-card.ai-recommended {
      border-color: var(--green-500);
    }

    .travel-card.ai-recommended:hover {
      box-shadow: var(--shadow-glow), var(--shadow-lg);
    }

    .travel-card.ai-recommended::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--green-500), var(--green-400));
    }

    .travel-card .compare-check {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 24px;
      height: 24px;
      border: 2px solid var(--gray-300);
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .travel-card .compare-check:hover {
      border-color: var(--soft-blue-500);
    }

    .travel-card .compare-check.selected {
      background: var(--soft-blue-500);
      border-color: var(--soft-blue-500);
    }

    .travel-card .compare-check.selected::after {
      content: '‚úì';
      color: white;
      font-size: 14px;
      font-weight: 700;
    }

    .card-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 0.6875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .badge-verified {
      background: var(--green-500);
      color: white;
    }

    .badge-women-safety {
      background: linear-gradient(135deg, #EC4899, #DB2777);
      color: white;
    }

    .badge-best-value {
      background: linear-gradient(135deg, var(--green-500), var(--green-600));
      color: white;
    }

    .route-info {
      font-size: 1.125rem;
      font-weight: 700;
      color: var(--gray-900);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .route-arrow {
      color: var(--soft-blue-500);
      font-size: 1rem;
    }

    .transport-type {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--gray-500);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 4px;
    }

    .timing-grid {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 12px;
      align-items: center;
      margin-bottom: 16px;
      padding: 12px 16px;
      background: var(--gray-50);
      border-radius: var(--radius-sm);
    }

    .timing-item {
      text-align: center;
    }

    .timing-item.center {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
    }

    .timing-label {
      font-size: 0.6875rem;
      font-weight: 600;
      color: var(--gray-500);
      text-transform: uppercase;
    }

    .timing-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9375rem;
      font-weight: 600;
      color: var(--gray-800);
    }

    .duration-badge {
      font-size: 0.75rem;
      color: var(--gray-600);
    }

    .price-section {
      margin-bottom: 16px;
    }

    .base-fare {
      font-size: 0.8125rem;
      color: var(--gray-600);
      margin-bottom: 4px;
    }

    .final-price {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--gray-900);
      font-family: 'JetBrains Mono', monospace;
      transition: transform 0.2s ease, color 0.2s ease;
    }

    .travel-card:hover .final-price {
      transform: scale(1.02);
      color: var(--green-600);
    }

    .transparency-trigger {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 8px;
      font-size: 0.8125rem;
      font-weight: 600;
      color: var(--green-600);
      cursor: pointer;
      background: none;
      border: none;
      transition: color 0.2s;
    }

    .transparency-trigger:hover {
      color: var(--green-500);
    }

    .expandable-breakdown {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.35s ease;
      margin-top: 0;
    }

    .expandable-breakdown.open {
      max-height: 240px;
    }

    .expandable-breakdown-inner {
      padding: 12px 16px;
      background: var(--gray-50);
      border-radius: var(--radius-sm);
      margin-top: 8px;
      font-size: 0.8125rem;
    }

    .expandable-breakdown-inner div {
      display: flex;
      justify-content: space-between;
      padding: 4px 0;
    }

    .expandable-breakdown-inner div:last-child {
      font-weight: 600;
      margin-top: 6px;
      padding-top: 8px;
      border-top: 1px solid var(--gray-200);
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 16px;
    }

    .metric {
      padding: 10px 12px;
      background: var(--gray-50);
      border-radius: var(--radius-sm);
    }

    .metric-label {
      font-size: 0.6875rem;
      font-weight: 600;
      color: var(--gray-500);
      text-transform: uppercase;
      margin-bottom: 4px;
    }

    .metric-value {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .score-bar {
      flex: 1;
      height: 6px;
      background: var(--gray-200);
      border-radius: 3px;
      overflow: hidden;
    }

    .score-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.5s ease;
    }

    .score-fill.green { background: linear-gradient(90deg, var(--green-400), var(--green-600)); }
    .score-fill.yellow { background: linear-gradient(90deg, #FBBF24, #F59E0B); }
    .score-fill.orange { background: linear-gradient(90deg, #FB923C, #EA580C); }

    .metric-number {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.875rem;
      font-weight: 600;
      min-width: 36px;
    }

    .availability-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .availability-dot.green { background: var(--green-500); }
    .availability-dot.yellow { background: #FBBF24; }
    .availability-dot.red { background: #EF4444; }

    .rating-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 16px;
    }

    .rating-stars {
      color: #FBBF24;
      font-size: 0.875rem;
    }

    .rating-text {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--gray-800);
    }

    .rating-count {
      font-size: 0.75rem;
      color: var(--gray-500);
    }

    .card-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--gray-100);
    }

    .btn-primary {
      flex: 1;
      padding: 12px 20px;
      background: linear-gradient(135deg, var(--green-500), var(--green-600));
      color: white;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 0.9375rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }

    .btn-secondary {
      padding: 12px 16px;
      background: var(--gray-100);
      color: var(--gray-800);
      border: none;
      border-radius: var(--radius-sm);
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-secondary:hover {
      background: var(--gray-200);
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.5);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 24px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
      display: flex;
      opacity: 1;
    }

    .modal {
      background: var(--white);
      border-radius: var(--radius);
      max-width: 480px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      transform: scale(0.95);
      transition: transform 0.3s ease;
    }

    .modal-overlay.active .modal {
      transform: scale(1);
    }

    .modal-header {
      padding: 24px 24px 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .modal-header h2 {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--gray-900);
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--gray-500);
      cursor: pointer;
      padding: 4px;
      line-height: 1;
    }

    .modal-body {
      padding: 24px;
    }

    .breakdown-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid var(--gray-100);
      font-size: 0.9375rem;
    }

    .breakdown-row:last-child {
      border-bottom: none;
    }

    .breakdown-row.highlight {
      background: var(--soft-blue-50);
      margin: 0 -24px;
      padding: 12px 24px;
      border-radius: var(--radius-sm);
    }

    .breakdown-row .verified {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--green-600);
      font-weight: 600;
    }

    .breakdown-row .verified svg {
      width: 18px;
      height: 18px;
    }

    .market-comparison {
      margin-top: 20px;
      padding: 16px;
      background: linear-gradient(135deg, var(--green-50), var(--white));
      border: 1px solid var(--green-200);
      border-radius: var(--radius-sm);
    }

    .market-comparison p {
      font-size: 0.875rem;
      color: var(--gray-700);
    }

    .market-comparison strong {
      color: var(--green-600);
    }

    /* Side by side comparison view */
    .comparison-view {
      display: none;
      margin-top: 24px;
    }

    .comparison-view.active {
      display: block;
    }

    .comparison-cards {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    /* Swipe hint for mobile comparison */
    .comparison-slot {
      touch-action: pan-y;
    }

    @media (max-width: 768px) {
      .comparison-mode {
        flex-direction: column;
      }

      .comparison-slots {
        display: flex;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        padding-bottom: 8px;
      }

      .comparison-slot {
        scroll-snap-align: start;
        flex-shrink: 0;
      }
      .comparison-section {
        padding: 20px 16px 48px;
      }

      .filters-bar {
        flex-direction: column;
        align-items: stretch;
        padding: 20px;
      }

      .filter-group {
        width: 100%;
      }

      .filter-group select {
        min-width: 100%;
      }

      .toggle-group {
        flex-wrap: wrap;
      }

      .travel-cards-grid {
        grid-template-columns: 1fr;
      }

      .comparison-cards {
        grid-template-columns: 1fr;
      }

      .timing-grid {
        grid-template-columns: 1fr 1fr 1fr;
      }
    }
  </style>
</head>
<body>
  <section class="comparison-section">
    <div class="section-header">
      <h1>Compare Travel Options</h1>
      <p>Transparent pricing. AI-powered recommendations. Book with confidence.</p>
    </div>

    <!-- Filters -->
    <div class="filters-bar">
      <div class="filter-group">
        <label>Departure Time</label>
        <select id="departureTime">
          <option>06:00 - 09:00</option>
          <option>09:00 - 12:00</option>
          <option>12:00 - 18:00</option>
          <option>18:00 - 22:00</option>
          <option>Anytime</option>
        </select>
      </div>
      <div class="filter-group">
        <label>Budget (‚Çπ)</label>
        <div class="budget-slider">
          <input type="range" id="budget" min="500" max="5000" value="2500" step="100">
          <span class="budget-value" id="budgetValue">‚Çπ2,500</span>
        </div>
      </div>
      <div class="filter-group">
        <label>Comfort Level</label>
        <select id="comfort">
          <option>Any</option>
          <option>Economy</option>
          <option>Standard</option>
          <option>Premium</option>
        </select>
      </div>
      <div class="filter-group">
        <label>Sort By</label>
        <div class="toggle-group">
          <button class="toggle-btn" data-sort="cheapest">Cheapest</button>
          <button class="toggle-btn" data-sort="fastest">Fastest</button>
          <button class="toggle-btn active" data-sort="smartest">Smartest</button>
        </div>
      </div>
      <div class="ai-toggle">
        <input type="checkbox" id="aiRecommended" checked>
        <span>AI Recommended</span>
      </div>
    </div>

    <!-- Comparison Mode -->
    <div class="comparison-mode">
      <span>Compare up to 3:</span>
      <div class="comparison-slots">
        <div class="comparison-slot" data-slot="0">Slot 1</div>
        <div class="comparison-slot" data-slot="1">Slot 2</div>
        <div class="comparison-slot" data-slot="2">Slot 3</div>
      </div>
      <button class="btn-secondary" id="clearCompare" style="margin-left: auto;">Clear</button>
    </div>

    <!-- AI Insight -->
    <div class="ai-insight-panel">
      <div class="ai-insight-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
        </svg>
      </div>
      <div class="ai-insight-content">
        <h3>AI Suggestion</h3>
        <p id="aiSuggestionText">This option is <strong>12% cheaper</strong> than average and has <strong>87% on-time probability</strong>. Best value for your route.</p>
      </div>
    </div>

    <!-- Travel Cards -->
    <div class="travel-cards-grid" id="travelCards">
      <!-- Cards injected by JS -->
    </div>

    <!-- Comparison View -->
    <div class="comparison-view" id="comparisonView">
      <h2 style="margin-bottom: 20px; font-size: 1.25rem;">Side-by-Side Comparison</h2>
      <div class="comparison-cards" id="comparisonCards"></div>
    </div>
  </section>

  <!-- Price Transparency Modal -->
  <div class="modal-overlay" id="transparencyModal">
    <div class="modal">
      <div class="modal-header">
        <h2>Price Transparency Breakdown</h2>
        <button class="modal-close" id="closeModal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="breakdown-row">
          <span>Base Fare</span>
          <span id="modalBaseFare">‚Çπ899</span>
        </div>
        <div class="breakdown-row">
          <span>Dynamic Pricing Factor</span>
          <span id="modalDynamic">+‚Çπ45</span>
        </div>
        <div class="breakdown-row">
          <span>Platform Service Fee</span>
          <span id="modalPlatform">‚Çπ49</span>
        </div>
        <div class="breakdown-row">
          <span>Operator Commission</span>
          <span id="modalCommission">‚Çπ67</span>
        </div>
        <div class="breakdown-row">
          <span>Hidden Charges</span>
          <span class="verified">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
            ‚Çπ0 Verified
          </span>
        </div>
        <div class="breakdown-row highlight">
          <span><strong>Final Price</strong></span>
          <span id="modalFinal" style="font-weight: 700; font-family: 'JetBrains Mono', monospace;">‚Çπ1,060</span>
        </div>
        <div class="market-comparison">
          <p>üìä <strong>Market Comparison:</strong> This price is <strong>12% below</strong> the average market rate of ‚Çπ1,204 for similar routes.</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    const travelData = [
      {
        id: 1,
        type: 'Train',
        source: 'Mumbai CST',
        destination: 'Pune Junction',
        departure: '07:30',
        arrival: '10:45',
        duration: '3h 15m',
        baseFare: 899,
        taxes: 161,
        finalPrice: 1060,
        comfortScore: 8.2,
        punctuality: 87,
        cleanliness: 8.5,
        confidenceIndex: 92,
        womenSafety: 9.1,
        availability: 'green',
        crowdLevel: 65,
        verified: true,
        rating: 4.8,
        reviews: 12453,
        bestValue: true,
        aiRecommended: true
      },
      {
        id: 2,
        type: 'Bus',
        source: 'Mumbai CST',
        destination: 'Pune Junction',
        departure: '08:00',
        arrival: '12:30',
        duration: '4h 30m',
        baseFare: 549,
        taxes: 51,
        finalPrice: 600,
        comfortScore: 6.8,
        punctuality: 72,
        cleanliness: 7.2,
        confidenceIndex: 78,
        womenSafety: 8.4,
        availability: 'yellow',
        crowdLevel: 45,
        verified: true,
        rating: 4.6,
        reviews: 8234,
        bestValue: false,
        aiRecommended: false
      },
      {
        id: 3,
        type: 'Flight',
        source: 'Mumbai CST',
        destination: 'Pune Junction',
        departure: '09:15',
        arrival: '09:55',
        duration: '40m',
        baseFare: 1899,
        taxes: 401,
        finalPrice: 2300,
        comfortScore: 9.1,
        punctuality: 94,
        cleanliness: 9.0,
        confidenceIndex: 96,
        womenSafety: 9.5,
        availability: 'green',
        crowdLevel: 30,
        verified: true,
        rating: 4.9,
        reviews: 4521,
        bestValue: false,
        aiRecommended: true
      },
      {
        id: 4,
        type: 'Metro',
        source: 'Andheri',
        destination: 'Ghatkopar',
        departure: '07:45',
        arrival: '08:15',
        duration: '30m',
        baseFare: 40,
        taxes: 0,
        finalPrice: 40,
        comfortScore: 7.5,
        punctuality: 98,
        cleanliness: 8.8,
        confidenceIndex: 95,
        womenSafety: 9.2,
        availability: 'red',
        crowdLevel: 85,
        verified: true,
        rating: 4.7,
        reviews: 25678,
        bestValue: true,
        aiRecommended: true
      }
    ];

    function formatPrice(n) {
      return '‚Çπ' + n.toLocaleString('en-IN');
    }

    function getScoreColor(score) {
      if (score >= 8) return 'green';
      if (score >= 6) return 'yellow';
      return 'orange';
    }

    function getStars(rating) {
      const full = Math.floor(rating);
      const half = rating % 1 >= 0.5 ? 1 : 0;
      return '‚òÖ'.repeat(full) + (half ? '¬Ω' : '') + '‚òÜ'.repeat(5 - full - half);
    }

    function renderCard(item, showCompare = true) {
      const comfortColor = getScoreColor(item.comfortScore);
      return `
        <div class="travel-card ${item.bestValue ? 'best-value' : ''} ${item.aiRecommended ? 'ai-recommended' : ''}" data-id="${item.id}">
          ${showCompare ? `<div class="compare-check" data-id="${item.id}" role="button" aria-label="Add to comparison"></div>` : ''}
          <div class="card-badges">
            ${item.verified ? '<span class="badge badge-verified">‚úì Verified Operator</span>' : ''}
            <span class="badge badge-women-safety">üõ°Ô∏è Women Safety ${item.womenSafety}/10</span>
            ${item.bestValue ? '<span class="badge badge-best-value">Best Value</span>' : ''}
          </div>
          <div class="transport-type">${item.type}</div>
          <div class="route-info">${item.source} <span class="route-arrow">‚Üí</span> ${item.destination}</div>
          <div class="timing-grid">
            <div class="timing-item">
              <div class="timing-label">Depart</div>
              <div class="timing-value">${item.departure}</div>
            </div>
            <div class="timing-item center">
              <div class="timing-value">${item.duration}</div>
              <div class="duration-badge">Duration</div>
            </div>
            <div class="timing-item">
              <div class="timing-label">Arrive</div>
              <div class="timing-value">${item.arrival}</div>
            </div>
          </div>
          <div class="price-section">
            <div class="base-fare">Base: ${formatPrice(item.baseFare)} + ${formatPrice(item.taxes)} taxes</div>
            <div class="final-price">${formatPrice(item.finalPrice)}</div>
            <button class="transparency-trigger" data-toggle-breakdown data-id="${item.id}" aria-expanded="false">
              View Price Breakdown ‚Ü≥
            </button>
            <div class="expandable-breakdown">
              <div class="expandable-breakdown-inner">
                <div><span>Base fare</span><span>${formatPrice(item.baseFare)}</span></div>
                <div><span>Taxes & fees</span><span>${formatPrice(item.taxes)}</span></div>
                <div><span>Hidden charges</span><span style="color: var(--green-600);">‚Çπ0 ‚úì</span></div>
                <div><span>Final</span><span>${formatPrice(item.finalPrice)}</span></div>
                <button class="transparency-trigger full-breakdown-link" data-id="${item.id}" style="margin-top: 8px; font-size: 0.75rem;">See full breakdown with market comparison ‚Üí</button>
              </div>
            </div>
          </div>
          <div class="metrics-grid">
            <div class="metric">
              <div class="metric-label">Comfort Score</div>
              <div class="metric-value">
                <div class="score-bar"><div class="score-fill ${comfortColor}" style="width: ${item.comfortScore * 10}%"></div></div>
                <span class="metric-number">${item.comfortScore}/10</span>
              </div>
            </div>
            <div class="metric">
              <div class="metric-label">Punctuality (AI)</div>
              <div class="metric-value">
                <div class="score-bar"><div class="score-fill ${getScoreColor(item.punctuality / 10)}" style="width: ${item.punctuality}%"></div></div>
                <span class="metric-number">${item.punctuality}%</span>
              </div>
            </div>
            <div class="metric">
              <div class="metric-label">Cleanliness</div>
              <div class="metric-value">
                <div class="score-bar"><div class="score-fill green" style="width: ${item.cleanliness * 10}%"></div></div>
                <span class="metric-number">${item.cleanliness}</span>
              </div>
            </div>
            <div class="metric">
              <div class="metric-label">Travel Confidence</div>
              <div class="metric-value">
                <div class="score-bar"><div class="score-fill green" style="width: ${item.confidenceIndex}%"></div></div>
                <span class="metric-number">${item.confidenceIndex}%</span>
              </div>
            </div>
          </div>
          <div class="metrics-grid">
            <div class="metric">
              <div class="metric-label">Seat Availability</div>
              <div class="metric-value">
                <span class="availability-dot ${item.availability}"></span>
                <span>${item.availability === 'green' ? 'Available' : item.availability === 'yellow' ? 'Limited' : 'Few'}</span>
              </div>
            </div>
            <div class="metric">
              <div class="metric-label">Crowd Level</div>
              <div class="metric-value">
                <div class="score-bar"><div class="score-fill ${item.crowdLevel > 70 ? 'orange' : item.crowdLevel > 40 ? 'yellow' : 'green'}" style="width: ${item.crowdLevel}%"></div></div>
                <span class="metric-number">${item.crowdLevel}%</span>
              </div>
            </div>
          </div>
          <div class="rating-row">
            <span class="rating-stars">${getStars(item.rating)}</span>
            <span class="rating-text">${item.rating}</span>
            <span class="rating-count">(${item.reviews.toLocaleString()} reviews)</span>
          </div>
          <div class="card-actions">
            <button class="btn-primary">Book Now</button>
            <button class="btn-secondary">Save</button>
          </div>
        </div>
      `;
    }

    function renderCards() {
      const grid = document.getElementById('travelCards');
      const aiOn = document.getElementById('aiRecommended').checked;
      let items = [...travelData];
      if (aiOn) items = items.filter(i => i.aiRecommended);
      grid.innerHTML = items.map(i => renderCard(i)).join('');
      attachCardListeners();
    }

    let selectedForCompare = [];

    function attachCardListeners() {
      document.querySelectorAll('.compare-check').forEach(el => {
        el.addEventListener('click', () => {
          const id = parseInt(el.dataset.id);
          const idx = selectedForCompare.indexOf(id);
          if (idx >= 0) {
            selectedForCompare.splice(idx, 1);
          } else if (selectedForCompare.length < 3) {
            selectedForCompare.push(id);
          }
          updateCompareUI();
        });
      });

      document.querySelectorAll('.transparency-trigger').forEach(btn => {
        btn.addEventListener('click', (e) => {
          if (btn.classList.contains('full-breakdown-link')) {
            e.stopPropagation();
            const item = travelData.find(i => i.id === parseInt(btn.dataset.id));
            if (item) openTransparencyModal(item);
            return;
          }
          if (btn.hasAttribute('data-toggle-breakdown')) {
            const card = btn.closest('.travel-card');
            const breakdown = card.querySelector('.expandable-breakdown');
            const isOpen = breakdown.classList.toggle('open');
            btn.setAttribute('aria-expanded', isOpen);
            btn.textContent = isOpen ? 'Hide Breakdown ‚ñ≤' : 'View Price Breakdown ‚Ü≥';
          }
        });
      });
    }

    function updateCompareUI() {
      document.querySelectorAll('.compare-check').forEach(el => {
        el.classList.toggle('selected', selectedForCompare.includes(parseInt(el.dataset.id)));
      });
      document.querySelectorAll('.comparison-slot').forEach((slot, i) => {
        const id = selectedForCompare[i];
        const item = id ? travelData.find(t => t.id === id) : null;
        slot.textContent = item ? `${item.type} ‚Ä¢ ${formatPrice(item.finalPrice)}` : `Slot ${i + 1}`;
        slot.classList.toggle('filled', !!item);
      });
      const view = document.getElementById('comparisonView');
      const cards = document.getElementById('comparisonCards');
      if (selectedForCompare.length >= 2) {
        view.classList.add('active');
        cards.innerHTML = selectedForCompare
          .map(id => travelData.find(t => t.id === id))
          .filter(Boolean)
          .map(item => renderCard(item, false))
          .join('');
      } else {
        view.classList.remove('active');
      }
    }

    function openTransparencyModal(item) {
      const marketAvg = Math.round(item.finalPrice * 1.12);
      const diff = Math.round(((marketAvg - item.finalPrice) / marketAvg) * 100);
      document.getElementById('modalBaseFare').textContent = formatPrice(item.baseFare);
      document.getElementById('modalDynamic').textContent = '+' + formatPrice(Math.round(item.baseFare * 0.05));
      document.getElementById('modalPlatform').textContent = formatPrice(49);
      document.getElementById('modalCommission').textContent = formatPrice(item.taxes - 49);
      document.getElementById('modalFinal').textContent = formatPrice(item.finalPrice);
      document.querySelector('.market-comparison p').innerHTML = 
        `üìä <strong>Market Comparison:</strong> This price is <strong>${diff}% below</strong> the average market rate of ${formatPrice(marketAvg)} for similar routes.`;
      document.getElementById('transparencyModal').classList.add('active');
    }

    function closeModal() {
      document.getElementById('transparencyModal').classList.remove('active');
    }
    document.getElementById('closeModal').addEventListener('click', closeModal);
    document.getElementById('transparencyModal').addEventListener('click', (e) => {
      if (e.target.id === 'transparencyModal') closeModal();
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });

    document.getElementById('budget').addEventListener('input', (e) => {
      document.getElementById('budgetValue').textContent = formatPrice(parseInt(e.target.value));
    });

    document.querySelectorAll('.toggle-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });
    });

    document.getElementById('aiRecommended').addEventListener('change', renderCards);
    document.getElementById('clearCompare').addEventListener('click', () => {
      selectedForCompare = [];
      updateCompareUI();
    });

    renderCards();
    updateCompareUI();
  </script>
  <script>
  document.addEventListener('click', function(e) {
    // Check if the clicked element is the "Book Now" button
    const btn = e.target.closest('.btn-primary');
    if (btn && btn.innerText.includes('Book Now')) {
      const card = btn.closest('.travel-card');
      
      // Extract data from the travel-card using the classes already in your HTML
      const bookingData = {
        transportType: card.querySelector('.transport-type')?.innerText || 'Travel',
        route: card.querySelector('.route-info')?.innerText.trim() || 'Route info',
        departure: card.querySelector('.timing-item:first-child .timing-value')?.innerText || '00:00',
        arrival: card.querySelector('.timing-item:last-child .timing-value')?.innerText || '00:00',
        duration: card.querySelector('.duration-badge')?.innerText || 'N/A',
        baseFare: card.querySelector('.base-fare')?.innerText.replace('Base Fare: ', '') || '‚Çπ0',
        finalPrice: card.querySelector('.final-price')?.innerText || '‚Çπ0',
        // Calculate taxes from the data provided in the card
        taxes: (parseInt(card.querySelector('.final-price')?.innerText.replace(/[^0-9]/g, '')) - 
                parseInt(card.querySelector('.base-fare')?.innerText.replace(/[^0-9]/g, ''))) || 0
      };

      // Save to localStorage for the next page to read
      localStorage.setItem('selectedBooking', JSON.stringify(bookingData));

      // Redirect to the payment page
      window.location.href = 'payment.html';
    }
  });
</script>
</body>
</html>

